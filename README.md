# AI-Driven Stock Market Analysis: Integrating Multimodal Data and Machine Learning for Predictive Insights

## 📈 AI-Driven Stock Market Analysis  
*A comprehensive framework for stock market forecasting using time series analysis, news sentiment integration, and deep learning.*

---

## 📖 Project Overview  
This project integrates **multimodal data sources** (historical stock prices, technical indicators, and news sentiment) with machine learning models to provide actionable insights into stock market trends. It combines quantitative analysis (LSTM forecasting, volatility clustering, backtesting) with qualitative news sentiment analysis via the DeepSeek API to generate trading recommendations. The system is designed for academic research and exploratory financial analysis.

---

## ✨ Key Features  
1. **Time Series Analysis**  
   - Technical indicators (RSI, MACD, ADX, Bollinger Bands).  
   - Volatility clustering and anomaly detection.  
   - Interactive visualizations using Plotly and Matplotlib.  

2. **News Sentiment Integration**  
   - Web scraping from Google News, Yahoo Finance, Sina, and AAStocks.  
   - Sentiment aggregation for AI-driven analysis.  

3. **Predictive Modeling**  
   - LSTM-based price forecasting (univariate and multivariate).  
   - Backtesting strategies using Backtrader.  

4. **AI-Powered Recommendations**  
   - Integration with DeepSeek API for risk assessment and trading signals.  
   - Automated report generation with buy/sell recommendations.  

---

## 🛠️ Installation  
1. **Clone the Repository**  
   ```bash  
   git clone https://github.com/LutherYTT/AI-Driven-Stock-Market-Analysis.git
   cd AI-Driven-Stock-Market-Analysis
   ```  

2. **Install Dependencies**  
   ```bash  
   pip install -r requirements.txt  
   ```  

3. **Set Up Environment Variables**  
   - Add your DeepSeek API key to `deepseek_integration.py`:  
     ```python  
     api_key = 'your-api-key-here'  
     ```  

4. **Create Output Directories**  
   ```bash  
   mkdir -p ./output/{stock_id}  # Replace {stock_id} with target ticker (e.g., 01810)  
   ```  

---

## 🚀 Usage  

### 1. Fetch Historical Data & Run Analysis  
```bash  
python time_series_analysis.py --ticker "01810.HK" --years 10  
```  
- Outputs: Enhanced CSV files, interactive charts, and statistical reports.  

### 2. Scrape News Articles  
```bash  
python web_crawlers.py --ticker "01810.HK" 
```  
- Outputs: CSV files in `./output/{stock_id}/` with news from Google, Yahoo, Sina, and AAStocks.  

### 3. Generate AI Recommendations  
```bash  
python deepseek_integration.py --ticker "01810.HK" --model "deepseek-reasoner"
```  
- Outputs: `Deepseet_Output.txt` with trading signals and risk assessments.  

---

## 📂 Project Structure  
```
├── assets/
├── src/  
│   ├── data_fetch.py           # Yahoo Finance data retrieval  
│   ├── preprocessing.py        # Technical indicators and feature engineering  
│   ├── visualization.py        # Interactive charts  
│   ├── advanced_analysis.py    # Volatility clustering, backtesting  
│   ├── news_scraper.py         # Web crawlers for news aggregation  
│   ├── deepseek_integration.py # AI analysis pipeline  
│   └── price_forecast.py       # LSTM models for forecasting  
├── output/                     # Generated reports, charts, and models
├── main.ipynb
├── time_series_analysis.py
├── web_crawlers.py
├── deepseek_integration.py
├── requirements.txt            # Dependency list  
└── README.md  
```  

---

## 📊 Example Outputs  
1. **Interactive Dashboard**  
   ![Interactive Chart Example](https://github.com/LutherYTT/AI-Driven-Stock-Market-Analysis/blob/main/asstes/interactive_chart.gif)  

2. **Return Distribution**
   ![Return Distribution Example](https://github.com/LutherYTT/AI-Driven-Stock-Market-Analysis/blob/main/output/01810/return_distribution_20250602.png)

3. **Volatility Clustering**
   ![Volatility Clustering Example](https://github.com/LutherYTT/AI-Driven-Stock-Market-Analysis/blob/main/output/01810/volatility_clustering_20250602.png)

4. **Anomaly Detection**
   ![Anomaly Detection Example](https://github.com/LutherYTT/AI-Driven-Stock-Market-Analysis/blob/main/output/01810/anomaly_detection_20250602.png)

5. **LSTM Price Forecast**  
   ![Forecast Example 1](https://github.com/LutherYTT/AI-Driven-Stock-Market-Analysis/blob/main/asstes/single-feature_lstm.png)
   ![Forecast Example 2](https://github.com/LutherYTT/AI-Driven-Stock-Market-Analysis/blob/main/asstes/multifeature_lstm.png)  

6. **DeepSeek Analysis Report**
   #### [WARNING] This answer was generated by AI and is for informational purposes only, does not constitute investment advice, so please screen it carefully.
   ```
	### **Stock Analysis Report: Xiaomi Corporation (01810.HK)**  
	**Date: 2025-06-03**  

	---

	### **Summary & Core Recommendations**  
	- **Short-Term (5 days):** **Hold** (Neutral bias; watch for breakout above ¥51.75 or breakdown below ¥50.00).  
	- **Mid-Term (30 days):** **Buy** (Upside to ¥54–67 on strong fundamentals and YU7 catalyst).  
	- **Key Triggers:**  
	  - *Short-Term:* Resolution of legal overhang (Baidu lawsuit, June 13), YU7 pre-launch sentiment.  
	  - *Mid-Term:* YU7 production ramp-up (July), sustained EV demand, and government subsidies.  

	---

	### **Technical Analysis Key Points**  
	1. **Price Trends & Moving Averages:**  
	   - Current price (¥50.95) below 20-day MA (¥51.64) but above 50-day MA (¥49.51) and 200-day MA (¥35.26). **Mixed signals**: Short-term consolidation, but mid-term uptrend intact.  
	   - Resistance: ¥51.75 (recent high); Support: ¥50.00 (psychological level) and ¥49.50 (50-day MA).  

	2. **Volume & Momentum:**  
	   - Recent volume (183–206M shares/day) aligns with 30-day average (194M), no divergence.  
	   - **RSI_14:** 51.3 (neutral), recovering from oversold conditions (3-day RSI dipped to 43.6).  
	   - **MACD:** Bullish crossover (histogram positive at 0.92), but momentum slowing.  

	3. **Conclusion:**  
	   - Short-term range-bound (¥50–51.75); breakout above resistance could signal rally.  

	---

	### **Fundamental Analysis Key Points**  
	1. **Company-Specific:**  
	   - **Strong Q1 Earnings:** Revenue +47% YoY, gross margin record 22.8%, EV deliveries (28K SU7 in May).  
	   - **YU7 Catalyst:** July mass production expected; pre-launch hype could drive sentiment.  
	   - **Risks:** Baidu lawsuit (June 13), Huawei’s public criticism of quality standards.  

	2. **Industry/Macro:**  
	   - **Government Subsidies:** Beneficiary of consumer electronics/EV incentives (per Bernstein, CCB).  
	   - **EV Competition:** Price wars persist (industry利润率降至3.9%), but Xiaomi’s brand strength offsets risks.  
	   - **Macro:** HK retail slump (-2.3% YoY) and US tariff threats weigh on broader market sentiment.  

	---

	### **News Sentiment Analysis**  
	1. **Positive Sentiment (60%):**  
	   - Target price hikes (CCB: ¥67; Bernstein: ¥60) on strong earnings and subsidies.  
	   - YU7 production updates (July timeline) and SU7 delivery stability (28K/month).  

	2. **Negative Sentiment (30%):**  
	   - Baidu lawsuit (June 13) over "unfair competition."  
	   - Huawei’s余承东质疑小米汽车质量 ("not up to Huawei standards").  

	3. **Neutral (10%):**  
	   - Industry debates on EV "price war" sustainability.  

	**Overall:** Sentiment leans positive but tempered by legal/competitive risks.  

	---

	### **Comprehensive Evaluation**  
	1. **Short-Term (5 days):**  
	   - Technicals suggest consolidation; sentiment mixed (legal vs. YU7 hype).  
	   - **Action:** Hold; enter long if breaks ¥51.75 (target ¥54) or buy dips near ¥49.50 (stop-loss ¥48).  

	2. **Mid-Term (30 days):**  
	   - Fundamentals dominate: YU7 launch, subsidies, and EV growth support upside.  
	   - **Action:** Buy; PT ¥67 (CCB’s bull case) if YU7 execution succeeds.  

	---

	### **Key Risk Warnings**  
	1. **Legal:** Baidu lawsuit outcome (June 13) could trigger volatility.  
	2. **Competition:** EV price wars may squeeze margins.  
	3. **Macro:** HK market fragility (retail slump, tariff risks).  

	**Disclaimer:** Monitor YU7 production updates and broader market sentiment for adjustments.  
   ```  

---

## ⚠️ Disclaimer  
This project is for **academic and informational purposes only**. Stock market investments carry risks, and the predictions generated by this system should not be treated as financial advice. Always conduct independent research or consult a professional advisor.  

---

## 🙌 Acknowledgments  
- Libraries: `yfinance`, `Backtrader`, `Plotly`, `TensorFlow`.  
- Data Sources: Yahoo Finance, Google News, Sina, AAStocks.  
- AI Integration: DeepSeek API.
